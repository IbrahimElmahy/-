if("undefined"==typeof jQuery)throw new Error("bootstrap-imageupload's JavaScript requires jQuery.");!function(i){"use strict";var e={},n={init:t,disable:function(){this.addClass("imageupload-disabled")},enable:a,reset:function(){t.call(this,e)}};function t(n){e=i.extend({},i.fn.imageupload.defaultOptions,n);var t=this.find(".file-tab"),p=this.find(".panel-heading .btn:eq(0)"),u=t.find('input[type="file"]'),c=t.find(".btn:eq(1)"),b=this.find(".url-tab"),m=this.find(".panel-heading .btn:eq(1)"),h=b.find(".btn:eq(0)"),v=b.find(".btn:eq(1)");s(t),f(b),l(t),a.call(this),p.off(),u.off(),c.off(),m.off(),h.off(),v.off(),p.on("click",function(){i(this).blur(),l(t)}),u.on("change",function(){i(this).blur(),function(n){var t=n.find(".btn:eq(0)"),a=n.find(".btn:eq(1)"),l=t.find("input");if(n.find(".alert").remove(),n.find("img").remove(),t.find("span").text("تصفح الصور"),a.hide(),!l[0].files||!l[0].files[0])return;t.prop("disabled",!0);var s=l[0].files[0];!function(n,t){if(n.size/1024>e.maxFileSizeKb)return void t(!1,"الملف كبير جدا (اعلا حجم "+e.maxFileSizeKb+"kB).");var a=o(n.name);i.inArray(a,e.allowedFormats)>-1?t(!0,"ملف الصورة صالح."):t(!1,"نوع الملف غير مسموح به.")}(s,function(i,e){if(i){var o=new FileReader;o.onload=function(i){n.prepend(r(i.target.result)),t.find("span").text("تعديل"),a.css("display","inline-block")},o.onerror=function(){n.prepend(d("خطأ في تحميل ملف الصورة.")),l.val("")},o.readAsDataURL(s)}else n.prepend(d(e)),t.find("span").text("تصفح الصور"),l.val("");t.prop("disabled",!1)})}(t)}),c.on("click",function(){i(this).blur(),s(t)}),m.on("click",function(){i(this).blur(),function(i){var e=i.closest(".imageupload"),n=e.find(".panel-heading .btn:eq(1)");if(!n.hasClass("active")){var t=e.find(".file-tab");e.find(".panel-heading .btn:eq(0)").removeClass("active"),n.addClass("active"),t.hide(),i.show(),s(t)}}(b)}),h.on("click",function(){i(this).blur(),function(n){var t=n.find('input[type="text"]'),a=n.find(".btn:eq(0)"),l=n.find(".btn:eq(1)");n.find(".alert").remove(),n.find("img").remove(),l.hide();var s=t.val();if(!s)return void n.prepend(d("الرجاء إدخال عنوان URL للصورة."));t.prop("disabled",!0),a.prop("disabled",!0),function(n,t){var a=null,d=!1,r=new Image;r.onload=function(){if(!d){window.clearTimeout(a);var r=n;-1!==r.indexOf("?")&&(r=r.split("?")[0].split("#")[0]);var l=o(r);i.inArray(l,e.allowedFormats)>-1?t(!0,"عنوان URL للصورة صالح."):t(!1,"نوع الملف غير مسموح به.")}},r.onerror=function(){d||(window.clearTimeout(a),t(!1,"لم يتم العثور على صورة."))},r.src=n,a=window.setTimeout(function(){d=!0,r.src="???",t(!1,"انتهت مهلة تحميل الصورة.")},3e3)}(s,function(e,o){e?(n.find('input[type="hidden"]').val(s),i(r(s)).insertAfter(a.closest(".input-group")),l.css("display","inline-block")):n.prepend(d(o)),t.prop("disabled",!1),a.prop("disabled",!1)})}(b)}),v.on("click",function(){i(this).blur(),f(b)}),""!==e.imgSrc&&(!function(i,e){var n=i.find(".btn:eq(0)"),t=i.find(".btn:eq(1)");n.find("input");i.find(".alert").remove(),i.find("img").remove(),n.find("span").text("تصفح الصور"),t.hide(),n.prop("disabled",!0),i.prepend(r(e)),n.find("span").text("تعديل"),t.css("display","inline-block"),n.prop("disabled",!1)}(t,e.imgSrc),e.imgSrc="")}function a(){this.removeClass("imageupload-disabled")}function d(i){var e=[];return e.push('<div class="alert alert-danger alert-dismissible">'),e.push('<button type="button" class="close" data-dismiss="alert">'),e.push("<span>&times;</span>"),e.push("</button>"+i),e.push("</div>"),e.join("")}function r(i){return'<img src="'+i+'" alt="Image preview" class="thumbnail" style="max-width: '+e.maxWidth+"px; max-height: "+e.maxHeight+'px">'}function o(i){return i.substr(i.lastIndexOf(".")+1).toLowerCase()}function l(i){var e=i.closest(".imageupload"),n=e.find(".panel-heading .btn:eq(0)");if(!n.hasClass("active")){var t=e.find(".url-tab");e.find(".panel-heading .btn:eq(1)").removeClass("active"),n.addClass("active"),t.hide(),i.show(),f(t)}}function s(i){i.find(".alert").remove(),i.find("img").remove(),i.find(".btn span").text("تصفح الصور"),i.find(".btn:eq(1)").hide(),i.find("input").val("")}function f(i){i.find(".alert").remove(),i.find("img").remove(),i.find(".btn:eq(1)").hide(),i.find("input").val("")}i.fn.imageupload=function(e){var t=arguments;return this.filter("div").each(function(){if(n[e])n[e].apply(i(this),Array.prototype.slice.call(t,1));else{if("object"!=typeof e&&e)throw new Error('طريقة "'+e+'"لم يتم تعريفه لتحميل الصور.');n.init.apply(i(this),t)}})},i.fn.imageupload.defaultOptions={allowedFormats:["jpg","jpeg","png","jfif"],maxWidth:400,maxHeight:400,maxFileSizeKb:5e3,imgSrc:""}}(jQuery);